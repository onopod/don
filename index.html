<script src="./pomidi.js"></script>
<script src="./posmp.js"></script>
<script>
(async () => {
  let midi = null;
  let sampler = null;

  try {
    midi = await new pomidi();
    midi.setHandler((e) => {
      // MIDI入力イベント処理は不要なら空でOK
    });
  } catch(e) {
    console.error("MIDI初期化失敗", e);
  }

  // posmp はファイル指定なしでインスタンス生成だけ（内部音源利用想定）
  sampler = await new posmp();

  function playDon() {
    if(midi) midi.sendNoteOn(35);
    if(sampler) sampler.playDon ? sampler.playDon() : sampler.play();
  }
  function playKat() {
    if(midi) midi.sendNoteOn(38);
    if(sampler) sampler.playKat ? sampler.playKat() : sampler.play();
  }

  window.addEventListener("keydown", e => {
    // 音声初期化解除のためのresumeはpomidi/posmp内部で管理されている想定

    if(e.code === "Numpad0") {
      playDon();
    } else if (/Numpad[1-9]/.test(e.code)) {
      playKat();
    }
  });
})();
</script>
